#ifndef Fl_ChessBoard_H
#define Fl_ChessBoard_H

#include <FL/Fl_Widget.H>

#include <game.hpp>

class Fl_ChessBoard : public Fl_Widget {
 private:
  double scale;
  double dx;
  double dy;
  GameState *game_state;
  int selected_piece;
  int moves[81][81];
  Move last_move;
  bool show_number;
  int my_color;

 public:
  Fl_ChessBoard(int x, int y, int w, int h, int my_color = RED);
  void draw() override;
  virtual int handle(int event) override;
  void set_game_state(GameState *game_state);
  void handle_circle_click(int index);
  void fill_moves();
  void number(bool is_show);
  bool number();
  void color(int my_color);
  int color();
  void move(Move move);
};

const double CIRCLE_POSITIONS[81][2] = {
    {310, 30},
    {332.5, 68.97114317029974},
    {355, 107.94228634059948},
    {377.5, 146.91342951089922},
    {400, 185.88457268119896},
    {422.5, 224.8557158514987},
    {445, 263.82685902179844},
    {467.5, 302.7980021920982},
    {490, 341.7691453623979},
    {287.5, 68.97114317029974},
    {310, 107.94228634059948},
    {332.5, 146.91342951089922},
    {355, 185.88457268119896},
    {377.5, 224.8557158514987},
    {400, 263.82685902179844},
    {422.5, 302.7980021920982},
    {445, 341.7691453623979},
    {467.5, 380.74028853269766},
    {265, 107.94228634059948},
    {287.5, 146.91342951089922},
    {310, 185.88457268119896},
    {332.5, 224.8557158514987},
    {355, 263.82685902179844},
    {377.5, 302.7980021920982},
    {400, 341.7691453623979},
    {422.5, 380.74028853269766},
    {445, 419.7114317029974},
    {242.5, 146.91342951089922},
    {265, 185.88457268119896},
    {287.5, 224.8557158514987},
    {310, 263.82685902179844},
    {332.5, 302.7980021920982},
    {355, 341.7691453623979},
    {377.5, 380.74028853269766},
    {400, 419.7114317029974},
    {422.5, 458.68257487329714},
    {220, 185.88457268119896},
    {242.5, 224.8557158514987},
    {265, 263.82685902179844},
    {287.5, 302.7980021920982},
    {310, 341.7691453623979},
    {332.5, 380.74028853269766},
    {355, 419.7114317029974},
    {377.5, 458.68257487329714},
    {400, 497.6537180435969},
    {197.5, 224.8557158514987},
    {220, 263.82685902179844},
    {242.5, 302.7980021920982},
    {265, 341.7691453623979},
    {287.5, 380.74028853269766},
    {310, 419.7114317029974},
    {332.5, 458.68257487329714},
    {355, 497.6537180435969},
    {377.5, 536.6248612138966},
    {175, 263.82685902179844},
    {197.5, 302.7980021920982},
    {220, 341.7691453623979},
    {242.5, 380.74028853269766},
    {265, 419.7114317029974},
    {287.5, 458.68257487329714},
    {310, 497.6537180435969},
    {332.5, 536.6248612138966},
    {355, 575.5960043841964},
    {152.5, 302.7980021920982},
    {175, 341.7691453623979},
    {197.5, 380.74028853269766},
    {220, 419.7114317029974},
    {242.5, 458.68257487329714},
    {265, 497.6537180435969},
    {287.5, 536.6248612138966},
    {310, 575.5960043841964},
    {332.5, 614.5671475544962},
    {130, 341.7691453623979},
    {152.5, 380.74028853269766},
    {175, 419.7114317029974},
    {197.5, 458.68257487329714},
    {220, 497.6537180435969},
    {242.5, 536.6248612138966},
    {265, 575.5960043841964},
    {287.5, 614.5671475544962},
    {310, 653.5382907247958},
};

const double FAKE_CIRCLE_POSITIONS[][2] = {
    {512.5, 380.74028853}, {535., 419.7114317},   {557.5, 458.68257487}, {580., 497.65371804},  {490., 419.7114317},
    {512.5, 458.68257487}, {535., 497.65371804},  {467.5, 458.68257487}, {490., 497.65371804},  {445., 497.65371804},
    {107.5, 380.74028853}, {130., 419.7114317},   {152.5, 458.68257487}, {175., 497.65371804},  {85., 419.7114317},
    {107.5, 458.68257487}, {130., 497.65371804},  {62.5, 458.68257487},  {85., 497.65371804},   {40., 497.65371804},
    {445., 185.88457268},  {467.5, 224.85571585}, {490., 263.82685902},  {512.5, 302.79800219}, {490., 185.88457268},
    {512.5, 224.85571585}, {535., 263.82685902},  {535., 185.88457268},  {557.5, 224.85571585}, {580., 185.88457268},
    {40., 185.88457268},   {62.5, 224.85571585},  {85., 263.82685902},   {107.5, 302.79800219}, {85., 185.88457268},
    {107.5, 224.85571585}, {130., 263.82685902},  {130., 185.88457268},  {152.5, 224.85571585}, {175., 185.88457268},
};

const double STAR_SHAPE[18][2] = {
    {290.3, 0},     {329.7, 0},     {418.5, 153.8}, {596.1, 153.8}, {615.8, 187.9}, {527, 341.8},
    {615.8, 495.6}, {596.1, 529.7}, {418.5, 529.7}, {329.7, 683.5}, {290.3, 683.5}, {201.5, 529.7},
    {23.9, 529.7},  {4.2, 495.6},   {93, 341.8},    {4.2, 187.9},   {23.9, 153.8},  {201.5, 153.8},
};

#endif
